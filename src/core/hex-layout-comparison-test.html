<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hex Layout vs ASCII Renderer Comparison</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1a1a2e;
            color: #ffffff;
            padding: 20px;
            line-height: 1.6;
        }
        .test-case {
            background: #0f0f1e;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #00ff88;
        }
        h1 {
            color: #00ff88;
        }
        h2 {
            color: #88ddff;
            margin-top: 0;
        }
        h3 {
            color: #ffaa00;
            margin-bottom: 10px;
        }
        pre {
            background: #000;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            color: #00ff88;
        }
        .input {
            color: #ffaa00;
        }
        .comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        .column {
            background: #16162e;
            padding: 15px;
            border-radius: 4px;
        }
        .match {
            border: 2px solid #00ff88;
        }
        .mismatch {
            border: 2px solid #ff6b6b;
        }
        @media (max-width: 768px) {
            .comparison {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <h1>ðŸ§¬ Hex Layout Algorithm vs ASCII Renderer Comparison</h1>
    <p>Comparing output from hex-layout.js + hex-to-ascii.js vs original ascii-renderer.js</p>

    <div id="test-output"></div>

    <script type="module">
        // Import the hex layout functions
        import { sequenceToHexGrid } from './hex-layout.js';
        import { hexGridToASCII } from './hex-to-ascii.js';

        // Import the original ASCII renderer
        import ASCIIRenderer from '../renderers/ascii-renderer.js';

        const output = document.getElementById('test-output');

        function addProteinTest(title, sequence, bendPosition, bendAngle) {
            const testDiv = document.createElement('div');
            testDiv.className = 'test-case';

            const titleEl = document.createElement('h2');
            titleEl.textContent = title;
            testDiv.appendChild(titleEl);

            // Input
            const inputPre = document.createElement('pre');
            inputPre.className = 'input';
            inputPre.textContent = `Sequence: ${sequence}\nBend: ${bendPosition !== null ? `position ${bendPosition}, ${bendAngle}Â°` : 'none'}`;
            testDiv.appendChild(inputPre);

            // Generate outputs
            let hexOutput, asciiOutput;

            if (bendPosition === null) {
                // Straight sequence
                const hexGrid = sequenceToHexGrid(sequence, []);
                hexOutput = hexGridToASCII(hexGrid, { prefix: 'N-', suffix: '-C' });
                asciiOutput = ASCIIRenderer.renderProtein(sequence);
            } else {
                // With bend
                const bends = [{ position: bendPosition, angle: bendAngle, direction: 'right' }];
                const hexGrid = sequenceToHexGrid(sequence, bends);
                hexOutput = hexGridToASCII(hexGrid, { prefix: 'N-', suffix: '-C' });
                asciiOutput = ASCIIRenderer.renderProteinWithBend(sequence, bendPosition, bendAngle);
            }

            // Comparison grid
            const comparisonDiv = document.createElement('div');
            comparisonDiv.className = 'comparison';

            // Hex layout column
            const hexColumn = document.createElement('div');
            hexColumn.className = 'column';
            const hexTitle = document.createElement('h3');
            hexTitle.textContent = 'Hex Layout â†’ ASCII';
            hexColumn.appendChild(hexTitle);
            const hexPre = document.createElement('pre');
            hexPre.textContent = hexOutput;
            hexColumn.appendChild(hexPre);

            // ASCII Renderer column
            const asciiColumn = document.createElement('div');
            asciiColumn.className = 'column';
            const asciiTitle = document.createElement('h3');
            asciiTitle.textContent = 'Original ASCII Renderer';
            asciiColumn.appendChild(asciiTitle);
            const asciiPre = document.createElement('pre');
            asciiPre.textContent = asciiOutput;
            asciiColumn.appendChild(asciiPre);

            // Check if outputs match
            const match = hexOutput.trim() === asciiOutput.trim();
            if (match) {
                hexColumn.classList.add('match');
                asciiColumn.classList.add('match');
            } else {
                hexColumn.classList.add('mismatch');
                asciiColumn.classList.add('mismatch');
            }

            comparisonDiv.appendChild(hexColumn);
            comparisonDiv.appendChild(asciiColumn);
            testDiv.appendChild(comparisonDiv);

            // Add match status
            const statusDiv = document.createElement('div');
            statusDiv.style.marginTop = '10px';
            statusDiv.style.padding = '10px';
            statusDiv.style.background = match ? '#003322' : '#330022';
            statusDiv.style.borderRadius = '4px';
            statusDiv.style.color = match ? '#00ff88' : '#ff6b6b';
            statusDiv.textContent = match ? 'âœ“ Outputs match!' : 'âœ— Outputs differ';
            testDiv.appendChild(statusDiv);

            output.appendChild(testDiv);
        }

        function addRNATest(title, sequence, bendPosition) {
            const testDiv = document.createElement('div');
            testDiv.className = 'test-case';

            const titleEl = document.createElement('h2');
            titleEl.textContent = title;
            testDiv.appendChild(titleEl);

            // Input
            const inputPre = document.createElement('pre');
            inputPre.className = 'input';
            inputPre.textContent = `Sequence: ${sequence}\nBend: ${bendPosition !== null ? `position ${bendPosition}, 60Â°` : 'none'}`;
            testDiv.appendChild(inputPre);

            // Generate outputs
            let hexOutput, asciiOutput;

            if (bendPosition === null) {
                // Straight sequence
                const hexGrid = sequenceToHexGrid(sequence, []);
                hexOutput = hexGridToASCII(hexGrid, { prefix: '5\'-', suffix: '-3\'' });
                asciiOutput = ASCIIRenderer.renderRNA(sequence);
            } else {
                // With bend
                const bends = [{ position: bendPosition, angle: 60, direction: 'right' }];
                const hexGrid = sequenceToHexGrid(sequence, bends);
                hexOutput = hexGridToASCII(hexGrid, { prefix: '5\'-', suffix: '-3\'' });
                asciiOutput = ASCIIRenderer.renderRNAWithBend(sequence, bendPosition);
            }

            // Comparison grid
            const comparisonDiv = document.createElement('div');
            comparisonDiv.className = 'comparison';

            // Hex layout column
            const hexColumn = document.createElement('div');
            hexColumn.className = 'column';
            const hexTitle = document.createElement('h3');
            hexTitle.textContent = 'Hex Layout â†’ ASCII';
            hexColumn.appendChild(hexTitle);
            const hexPre = document.createElement('pre');
            hexPre.textContent = hexOutput;
            hexColumn.appendChild(hexPre);

            // ASCII Renderer column
            const asciiColumn = document.createElement('div');
            asciiColumn.className = 'column';
            const asciiTitle = document.createElement('h3');
            asciiTitle.textContent = 'Original ASCII Renderer';
            asciiColumn.appendChild(asciiTitle);
            const asciiPre = document.createElement('pre');
            asciiPre.textContent = asciiOutput;
            asciiColumn.appendChild(asciiPre);

            // Check if outputs match
            const match = hexOutput.trim() === asciiOutput.trim();
            if (match) {
                hexColumn.classList.add('match');
                asciiColumn.classList.add('match');
            } else {
                hexColumn.classList.add('mismatch');
                asciiColumn.classList.add('mismatch');
            }

            comparisonDiv.appendChild(hexColumn);
            comparisonDiv.appendChild(asciiColumn);
            testDiv.appendChild(comparisonDiv);

            // Add match status
            const statusDiv = document.createElement('div');
            statusDiv.style.marginTop = '10px';
            statusDiv.style.padding = '10px';
            statusDiv.style.background = match ? '#003322' : '#330022';
            statusDiv.style.borderRadius = '4px';
            statusDiv.style.color = match ? '#00ff88' : '#ff6b6b';
            statusDiv.textContent = match ? 'âœ“ Outputs match!' : 'âœ— Outputs differ';
            testDiv.appendChild(statusDiv);

            output.appendChild(testDiv);
        }

        // PROTEIN TESTS
        addProteinTest('Test 1: Straight Protein', 'STR-EX6-BTA', null, null);
        addProteinTest('Test 2: Protein with 60Â° Bend', 'STR-EX6-BTA', 1, 60);
        addProteinTest('Test 3: Protein with 120Â° Bend', 'STR-EX6-BTA', 1, 120);
        addProteinTest('Test 4: Longer Protein with 60Â° Bend', 'STR-EX6-BTA-RPF-CP6', 1, 60);
        addProteinTest('Test 5: Longer Protein with 120Â° Bend', 'STR-EX6-BTA-RPF', 1, 120);

        // RNA TESTS
        addRNATest('Test 6: Straight RNA', 'ACGU', null);
        addRNATest('Test 7: RNA with Bend', 'ACGU', 1);
        addRNATest('Test 8: RNA with Later Bend', 'ACGUA', 2);

    </script>
</body>
</html>
