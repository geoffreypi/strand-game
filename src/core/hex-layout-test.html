<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hex Layout Algorithm Test</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #1a1a2e;
            color: #ffffff;
            padding: 20px;
            line-height: 1.6;
        }
        .test-case {
            background: #0f0f1e;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid #00ff88;
        }
        h1 {
            color: #00ff88;
        }
        h2 {
            color: #88ddff;
            margin-top: 0;
        }
        pre {
            background: #000;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            color: #00ff88;
        }
        .input {
            color: #ffaa00;
        }
        .grid {
            color: #88ddff;
        }
        .error {
            color: #ff6b6b;
        }
    </style>
</head>
<body>
    <h1>ðŸ§¬ Hex Layout Algorithm - Visual Tests</h1>
    <p>Testing sequence + bends â†’ hex grid conversion</p>

    <div id="test-output"></div>

    <script type="module">
        // Import the hex layout functions
        import { sequenceToHexGrid, hexDistance } from './hex-layout.js';
        import { hexGridToASCII, hexGridToSimpleGrid } from './hex-to-ascii.js';

        const output = document.getElementById('test-output');

        function addTest(title, sequence, bends, options = {}) {
            const testDiv = document.createElement('div');
            testDiv.className = 'test-case';

            const titleEl = document.createElement('h2');
            titleEl.textContent = title;
            testDiv.appendChild(titleEl);

            // Input
            const inputPre = document.createElement('pre');
            inputPre.className = 'input';
            inputPre.textContent = `Sequence: ${sequence}\nBends: ${JSON.stringify(bends, null, 2)}`;
            testDiv.appendChild(inputPre);

            // Generate hex grid
            const hexGrid = sequenceToHexGrid(sequence, bends);

            // Show hex grid data
            const gridDataPre = document.createElement('pre');
            gridDataPre.className = 'grid';
            gridDataPre.textContent = 'Hex Grid:\n' + JSON.stringify(hexGrid, null, 2);
            testDiv.appendChild(gridDataPre);

            // Show ASCII visualization
            const asciiPre = document.createElement('pre');
            asciiPre.textContent = 'ASCII Visualization:\n' + hexGridToASCII(hexGrid, options);
            testDiv.appendChild(asciiPre);

            // Show simple grid (for debugging)
            const simplePre = document.createElement('pre');
            simplePre.textContent = 'Simple Grid (idx:type):\n' + hexGridToSimpleGrid(hexGrid);
            testDiv.appendChild(simplePre);

            output.appendChild(testDiv);
        }

        // Test 1: Straight sequence
        addTest(
            'Test 1: Straight Protein',
            'STR-EX6-BTA-RPF',
            [],
            { prefix: 'N-', suffix: '-C' }
        );

        // Test 2: One 60Â° right bend
        addTest(
            'Test 2: Protein with 60Â° Right Bend at Position 1',
            'STR-EX6-BTA-RPF-CP6',
            [{ position: 1, angle: 60, direction: 'right' }],
            { prefix: 'N-', suffix: '-C' }
        );

        // Test 3: One 120Â° right bend
        addTest(
            'Test 3: Protein with 120Â° Right Bend at Position 1',
            'STR-EX6-BTA-RPF',
            [{ position: 1, angle: 120, direction: 'right' }],
            { prefix: 'N-', suffix: '-C' }
        );

        // Test 4: Multiple bends (S-shape)
        addTest(
            'Test 4: Protein with Multiple Bends (S-shape)',
            'A-B-C-D-E-F',
            [
                { position: 1, angle: 60, direction: 'right' },
                { position: 3, angle: 60, direction: 'left' }
            ],
            { prefix: 'N-', suffix: '-C' }
        );

        // Test 5: RNA with bend
        addTest(
            'Test 5: RNA with 60Â° Bend',
            'ACGUA',
            [{ position: 2, angle: 60, direction: 'right' }],
            { prefix: '5\'-', suffix: '-3\'' }
        );

        // Test 6: Complex folding pattern
        addTest(
            'Test 6: Complex Folding Pattern',
            'STR-EX6-BTA-RPF-CP6-E12-C12-BTC',
            [
                { position: 1, angle: 60, direction: 'right' },
                { position: 3, angle: 60, direction: 'right' },
                { position: 5, angle: 120, direction: 'left' }
            ],
            { prefix: 'N-', suffix: '-C' }
        );

        // Test 7: Left bends
        addTest(
            'Test 7: Left Bends',
            'A-B-C-D',
            [
                { position: 1, angle: 60, direction: 'left' }
            ],
            { prefix: 'N-', suffix: '-C' }
        );

        // Test 8: Alternating bends
        addTest(
            'Test 8: Alternating Bends (Zigzag)',
            'A-B-C-D-E-F-G',
            [
                { position: 1, angle: 60, direction: 'right' },
                { position: 2, angle: 60, direction: 'left' },
                { position: 3, angle: 60, direction: 'right' },
                { position: 4, angle: 60, direction: 'left' }
            ],
            { prefix: 'N-', suffix: '-C' }
        );

    </script>
</body>
</html>
